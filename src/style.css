:root{
  --bg:#0f1220;
  --panel:#171a2e;
  --panel-2:#1f2340;
  --border:#2c3059;
  --text:#e6e8ff;
  --muted:#a8afff;
  --accent:#7c8cff;
  --primary:#5c7cff;
  --danger:#ff4d6d;
  --red:#ff3b3b;
  --blue:#2bb1ff;
}

*{ box-sizing: border-box; }
html, body, #root{ height: 100%; }
body{
  margin:0;
  font-family: 'Noto Sans KR', ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background: radial-gradient(1200px 600px at 50% -10%, #141a3a 0%, var(--bg) 60%);
  color: var(--text);
  -webkit-tap-highlight-color: transparent;
  touch-action: manipulation;
}

.app{
  max-width: 100vw;
  margin: 0 auto;
  padding: 8px 8px 82px; /* bottom space for sticky controls */
}

.header{ text-align: center; margin-bottom: 8px; }
.header h1{ font-size: 22px; margin: 6px 0 0; letter-spacing: .5px; color: #fff; }

/* Starfield background */
.app::before, .app::after{
  content:""; position: fixed; inset:0; pointer-events:none; z-index:-1;
  background-image: radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,.35) 0, rgba(255,255,255,0) 60%),
                    radial-gradient(1.5px 1.5px at 70% 20%, rgba(156,196,255,.35) 0, rgba(156,196,255,0) 60%),
                    radial-gradient(1.8px 1.8px at 40% 80%, rgba(255,230,180,.3) 0, rgba(255,230,180,0) 60%),
                    radial-gradient(1.2px 1.2px at 80% 60%, rgba(200,255,245,.3) 0, rgba(200,255,245,0) 60%);
  animation: twinkle 12s linear infinite;
}
@keyframes twinkle{
  0% { opacity:.6; transform: translateY(0); }
  50% { opacity:.8; transform: translateY(-5px); }
  100% { opacity:.6; transform: translateY(0); }
}

.hud-top{ display:flex; justify-content:space-between; align-items:center; padding:8px 12px; background: var(--panel); border-radius:12px; margin-bottom:12px; border:1px solid var(--border); }
.hud-left{ display:flex; align-items:center; gap:6px; font-weight:700; }
.hud-right{ font-size:18px; font-weight:900; display:flex; align-items:center; }
.timer-num.danger{ color: var(--danger); }

.card{
  background: linear-gradient(180deg, var(--panel) 0%, var(--panel-2) 100%);
  border: 1px solid var(--border);
  border-radius: 14px;
  padding: 12px;
  box-shadow: 0 6px 20px rgba(0,0,0,.25);
}

.hud{ display:grid; gap:10px; margin-bottom:12px; }
.turn{ display:flex; align-items:center; gap:8px; font-weight:700; }
.dot{ width:10px; height:10px; border-radius:999px; display:inline-block; box-shadow:0 0 10px rgba(255,255,255,.2); }
.dot.red{ background: var(--red); }
.dot.blue{ background: var(--blue); }

.stats{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; color: var(--muted); font-size: 13px; }
.badge{ background: #252a52; border:1px solid var(--border); padding:4px 8px; border-radius: 999px; font-weight:700; color:#cfd3ff; }

.timer{ display:flex; align-items:center; gap:8px; }
.timer-track{ position:relative; flex:1; height:10px; background:#202449; border-radius:999px; overflow:hidden; border:1px solid var(--border); }
.timer-fill{ position:absolute; left:0; top:0; bottom:0; background: linear-gradient(90deg, #6cf 0%, var(--primary) 100%); width:100%; transition: width .4s ease; }
.timer-fill.danger{ background: linear-gradient(90deg, #ff9a9a 0%, var(--danger) 100%); }
.timer-text{ font-variant-numeric: tabular-nums; font-weight:700; }

.gate-panel{ display:grid; gap:10px; margin-bottom:12px; }
.gate-ui{ display:grid; gap:12px; }
.input-box{ display:flex; gap:8px; justify-content:center; }
.input-chip{ background:#252a52; border:2px solid var(--border); padding:10px 12px; border-radius:8px; font-weight:700; text-align:center; }
.bit{ color:#fff; font-size:18px; }
.gates-row{ display:flex; gap:16px; justify-content:center; }
.gate-box{ background:#1f2340; border:2px solid var(--border); padding:12px; border-radius:12px; text-align:center; cursor:pointer; transition: transform .1s ease, border-color .2s ease; pointer-events: all; user-select: none; }
.gate-box:hover{ transform: scale(1.05); border-color: var(--accent); }
.gate-icon{ font-size:24px; font-weight:900; color:#fff; margin-bottom:4px; }
.gate-label{ font-size:12px; color: var(--muted); }
.output-box{ background:#252a52; border:2px solid var(--border); padding:12px; border-radius:12px; text-align:center; }
.output-bits{ display:flex; gap:12px; justify-content:center; margin-bottom:8px; font-weight:600; }
.output-bits span{ background:#1f2340; padding:4px 8px; border-radius:6px; }
.steps-num{ color:#fff; font-size:20px; font-weight:900; }

.board{ display:flex; justify-content:center; padding:8px; position:relative; }
#yut-board{ width: 100%; max-width: 400px; height:auto; background: radial-gradient(500px 500px at 50% 50%, #0b0f24 0%, #0a0d1f 60%, #080a18 100%); border-radius:14px; border:1px solid #2a3160; box-shadow: inset 0 0 40px rgba(0,0,0,.6), 0 0 30px rgba(60,90,255,.15); }
.gate-overlay{ position:absolute; top:14px; left:50%; transform:translateX(-50%); display:flex; gap:20px; pointer-events:none; }
.overlay-gate{ pointer-events:auto; background:#1f2340; border:2px solid var(--border); padding:8px; border-radius:50%; width:50px; height:50px; display:flex; align-items:center; justify-content:center; cursor:pointer; transition: transform .1s ease, border-color .2s ease; }
.overlay-gate:hover{ transform: scale(1.1); border-color: var(--accent); }
.overlay-gate .gate-icon{ font-size:20px; color:#fff; }
.reroll-btn{ pointer-events:auto; background: #2a2f5a; color:#e8ebff; border:1px solid var(--border); padding:8px 12px; border-radius:50%; width:50px; height:50px; font-size:18px; cursor:pointer; transition: transform .1s ease, background .2s ease; }
.reroll-btn:hover{ background: #3a3f6a; }
.reroll-btn.disabled{ opacity:.45; cursor:not-allowed; }

/* 가로 레이아웃: 보드 + 사이드 컨트롤 */
.board-row{ display:flex; gap:10px; align-items:flex-start; }
.side-controls{ display:flex; flex-direction:column; gap:8px; width:120px; }
.btn.full{ width:100%; }

/* 논리 영역 */
.logic-row{ display:flex; gap:12px; align-items:center; margin-top:10px; }
.logic-diagram{ flex:1; touch-action: none; }

.controls{
  position: fixed; left:0; right:0; bottom:0;
  display:flex; gap:8px; flex-wrap:wrap; justify-content:center;
  padding:10px; backdrop-filter: blur(8px);
  background: linear-gradient(180deg, rgba(10,12,24,.0), rgba(10,12,24,.85) 40%);
}

.btn{
  appearance:none; border:none; outline:none; cursor:pointer;
  padding:12px 14px; border-radius:12px; font-size:16px; font-weight:800; letter-spacing:.3px;
  background: #2a2f5a; color:#e8ebff; border:1px solid var(--border);
  box-shadow: 0 6px 16px rgba(0,0,0,.25), inset 0 0 0 1px rgba(255,255,255,.06);
  transition: transform .06s ease, filter .2s ease, background .2s ease;
}
.btn:hover{ filter: brightness(1.1); }
.btn:active{ transform: translateY(1px); }
.btn.primary{ background: linear-gradient(180deg, #5ef, #46b9ff); border-color:#2e7bd6; box-shadow: 0 0 14px rgba(70,185,255,.35), inset 0 0 0 1px rgba(255,255,255,.08); }
.btn.danger{ background: linear-gradient(180deg, #ff6b8a, #ff3f6a); border-color:#c02b49; }
.btn.disabled, .btn:disabled{ opacity:.45; cursor:not-allowed; }

/* 도움말 */
.help{ margin: 12px 0; }
.help summary{ cursor: pointer; font-weight:700; }
.help p{ color: var(--muted); margin:6px 0; }

/* 토큰 */
.token{ stroke:#000; stroke-width:1; filter: drop-shadow(0 2px 2px rgba(0,0,0,.4)); transition: cx .35s ease, cy .35s ease; }
.token.red{ fill: var(--red); filter: drop-shadow(0 0 8px rgba(255,59,59,.5)); }
.token.blue{ fill: var(--blue); filter: drop-shadow(0 0 8px rgba(43,177,255,.5)); }
.token.selected{ stroke: #fff; stroke-width:3; }

/* 토큰 이동/캡처 애니메이션 */
.token{ transform-box: fill-box; transform-origin: center; }
.token.moved{ animation: tokenPulse .4s ease-out; }
.token.captured{ animation: tokenCapture .5s ease-out; }
@keyframes tokenPulse{
  0%{ transform: scale(1); }
  50%{ transform: scale(1.18); }
  100%{ transform: scale(1); }
}
@keyframes tokenCapture{
  0%{ transform: scale(1); }
  40%{ transform: scale(1.28); }
  100%{ transform: scale(1); }
}

/* 피드백 애니메이션 */
@keyframes shakeX{ 0%,100%{ transform: translateX(0);} 25%{ transform: translateX(-4px);} 75%{ transform: translateX(4px);} }
.shake{ animation: shakeX .35s ease; }

/* 오버레이 */
.overlay{ position: fixed; inset:0; background: rgba(0,0,0,.55); display:flex; align-items:center; justify-content:center; padding:20px; }
.dialog{ background: var(--panel-2); border:1px solid var(--border); padding:18px; border-radius:14px; width: 90%; max-width: 360px; text-align:center; box-shadow: 0 8px 24px rgba(0,0,0,.4); }
.dialog h2{ margin:6px 0 10px; }
.dialog p{ color:#e9ecff; margin: 0 0 12px; font-weight:700; }

/* 메인 카드 중앙 정렬 래퍼 */
.center-stage{ position: fixed; inset: 0; display:flex; align-items:center; justify-content:center; padding:16px; }